(this.webpackJsonpmylinks=this.webpackJsonpmylinks||[]).push([[0],{14:function(e,t,n){},15:function(e,t,n){},16:function(e,t,n){},18:function(e,t,n){},19:function(e,t,n){"use strict";n.r(t);var i=n(5),o=n.n(i),s=n(8),r=n.n(s),a=(n(14),n(1)),l=n(2),c=n(4),u=n(3),d=(n(15),n(16),n(0)),h=function(e){Object(c.a)(n,e);var t=Object(u.a)(n);function n(){return Object(a.a)(this,n),t.apply(this,arguments)}return Object(l.a)(n,[{key:"render",value:function(){if(!this.props.show)return null;return Object(d.jsx)("div",{className:"backdrop",style:{position:"fixed",top:0,bottom:0,left:0,right:0,backgroundColor:"rgba(0,0,0,0.3)",padding:50},children:Object(d.jsx)("div",{className:"modal",style:{backgroundColor:"#fff",borderRadius:5,margin:"0 auto",maxWidth:750,minHeight:40},children:this.props.children})})}}]),n}(o.a.Component),f={theme:{missingFavIconColor:"blue"},hideShortcuts:!1},m=o.a.createContext(f);function v(e){e.list.reverse().forEach(b)}function b(e){window.open(e.url)}function y(e,t){var n=e.favicon;return n?/^.*:\/\//.test(n)?n:(null===t||void 0===t?void 0:t.replace("$1",n))||null:0===(null===n||void 0===n?void 0:n.length)?null:function(e,t){if(t)try{var n=new URL(e).host;if(n)return t.replace("$1",n)}catch(i){}return null}(e.url,t)}var k=function(){function e(t){Object(a.a)(this,e),this.myLinks=t,this.attachWidgetToLinks()}return Object(l.a)(e,[{key:"findWidgetById",value:function(e){return this.myLinks.columns.flat().find((function(t){return t.id===e}))}},{key:"hasShortcuts",value:function(){return e=this.myLinks,t=function(e,t){return!!t.shortcut},e.columns.some((function(e){return e.some((function(e){return e.list.some((function(n){return t(e,n)}))}))}));var e,t}},{key:"applyBackground",value:function(){var e,t=null===(e=this.myLinks.theme)||void 0===e?void 0:e.backgroundImage,n=document.body;n.style.backgroundImage=t?"url(".concat(t,")"):""}},{key:"applyTheme",value:function(){var t=this.myLinks.theme;t&&(e.setColor("--missing-favicon-color",t.missingFavIconColor),e.setColor("--link-key-background",t.linkKeyBackground),e.setColor("--link-key-color",t.linkKeyColor))}},{key:"createImage",value:function(e,t,n,i){var o=document.createElement("canvas"),s=o.getContext("2d");return s?(o.width=t,o.height=n,s.fillStyle=i,s.fillRect(0,0,t,n),s.fill(),s.globalCompositeOperation="destination-atop",s.drawImage(e,0,0),o.toDataURL()):null}},{key:"applyColorToFavIcon",value:function(e){var t=this;if(e){var n=document.querySelector('link[rel~="icon"]');if(n){var i=new Image;i.src=n.href,i.onload=function(){var o=t.createImage(i,16,16,e);o&&(n.type="image/x-icon",n.href=o)}}}}},{key:"attachWidgetToLinks",value:function(){this.myLinks.columns.flat().forEach((function(e){e.list.forEach((function(t){t.widget=e}))}))}}],[{key:"setColor",value:function(e,t){t?document.documentElement.style.setProperty(e,t):document.documentElement.style.removeProperty(e)}}]),e}(),j=function(e){Object(c.a)(n,e);var t=Object(u.a)(n);function n(){return Object(a.a)(this,n),t.apply(this,arguments)}return Object(l.a)(n,[{key:"render",value:function(){var e=this.context,t=this.props.value,n={visibility:e.hideShortcuts||!t.shortcut?"collapse":"visible"};return Object(d.jsx)("a",{href:t.url,target:"_blank",rel:"noopener noreferrer",className:"ml-widget-item-link",children:Object(d.jsxs)("div",{className:"content",children:[Object(d.jsxs)("div",{className:"left-items",children:[this.image(t),Object(d.jsx)("div",{className:"label",children:t.label})]}),Object(d.jsx)("div",{className:"right-items",children:Object(d.jsx)("kbd",{style:n,children:t.shortcut})})]})})}},{key:"image",value:function(e){var t=y(e,this.context.faviconService);return t?Object(d.jsx)("img",{src:t,className:"ml-favicon",alt:""}):Object(d.jsx)("div",{className:"missing-favicon ml-missing-favicon"})}}]),n}(o.a.Component);j.contextType=m;var p=function(e){Object(c.a)(n,e);var t=Object(u.a)(n);function n(){return Object(a.a)(this,n),t.apply(this,arguments)}return Object(l.a)(n,[{key:"render",value:function(){var e=this.props.value,t=e.list.map((function(e){return Object(d.jsx)("li",{children:Object(d.jsx)(j,{value:e})},e.url)}));return Object(d.jsxs)("div",{className:"ml-widget","data-list-id":e.id,children:[Object(d.jsxs)("div",{className:"ml-widget-label",children:[Object(d.jsx)("h2",{children:e.title}),Object(d.jsx)("span",{className:"ml-toolbar",onClick:function(){return v(e)},children:Object(d.jsx)("i",{className:"fa fa-external-link-alt"})})]}),Object(d.jsx)("ul",{children:t})]})}}]),n}(o.a.Component),g=function(e){Object(c.a)(n,e);var t=Object(u.a)(n);function n(){return Object(a.a)(this,n),t.apply(this,arguments)}return Object(l.a)(n,[{key:"render",value:function(){var e=this.props.value.map((function(e){return Object(d.jsx)(p,{value:e},e.id)}));return Object(d.jsx)("section",{className:"ml-rows",children:e})}}]),n}(o.a.Component),O=function(e){Object(c.a)(n,e);var t=Object(u.a)(n);function n(){return Object(a.a)(this,n),t.apply(this,arguments)}return Object(l.a)(n,[{key:"render",value:function(){var e=(this.props.columns||[]).map((function(e,t){return Object(d.jsx)(g,{value:e},t)}));return Object(d.jsx)("section",{className:"ml-columns",children:e})}}]),n}(o.a.Component),x="myLinksData",w=function(){function e(){Object(a.a)(this,e)}return Object(l.a)(e,null,[{key:"fromData",value:function(e){C.loadData((function(t){e(t)}))}},{key:"fromFile",value:function(e,t){C.loadFromFile(e,(function(e){t(e)}))}}]),e}(),C=function(){function e(){Object(a.a)(this,e)}return Object(l.a)(e,null,[{key:"loadData",value:function(t){var n,i=localStorage.getItem(x);if(i)try{n=e.loadFromObject(JSON.parse(i))}catch(o){window.alert(o)}t(n)}},{key:"loadFromObject",value:function(e){return e}},{key:"loadFromFile",value:function(t,n){var i=new FileReader;i.onload=function(t){var i,o=null===(i=t.target)||void 0===i?void 0:i.result,s="string"===typeof o?o:"";try{n(e.loadFromObject(JSON.parse(s))),localStorage.setItem(x,s)}catch(r){window.alert(r)}},i.readAsText(t)}}]),e}(),S=function(){function e(){var t=this;Object(a.a)(this,e),this.mouseX=0,this.mouseY=0,this.myLinksHolder=void 0,this.buffer="",document.addEventListener("mousemove",(function(e){return t.storeMousePosition(e)}),!1),document.addEventListener("mouseenter",(function(e){return t.storeMousePosition(e)}),!1)}return Object(l.a)(e,[{key:"setup",value:function(e){this.myLinksHolder=e,this.mouseX=0,this.mouseY=0}},{key:"findElement",value:function(e,t){for(;e;){if(Array.from(e.classList).some((function(e){return e===t})))return e;e=e.parentElement}return null}},{key:"storeMousePosition",value:function(e){this.mouseX=e.clientX,this.mouseY=e.clientY}},{key:"keyDown",value:function(e){if(e.ctrlKey||e.shiftKey||e.altKey||e.metaKey)return!1;if("a"===e.key)this.buffer="",this.openFromMousePosition();else if(this.myLinksHolder){this.buffer+=e.key;var t=this.findLinkByShortcut(this.myLinksHolder.myLinks);t&&b(t)}return!0}},{key:"findLinkByShortcut",value:function(e){var t=this,n=function(e,t){var n=[];return e.columns.forEach((function(e){e.forEach((function(e){e.list.forEach((function(i){t(e,i)&&n.push(i)}))}))})),n}(e,(function(e,n){var i;return!0===(null===(i=n.shortcut)||void 0===i?void 0:i.startsWith(t.buffer))}));if(0===n.length)this.buffer="";else if(1===n.length&&n[0].shortcut===this.buffer)return this.buffer="",n[0];return null}},{key:"openFromMousePosition",value:function(){if(this.myLinksHolder){var e=this.findElement(document.elementFromPoint(this.mouseX,this.mouseY),"ml-widget");if(e&&e.dataset.listId){var t=this.myLinksHolder.findWidgetById(e.dataset.listId);t&&v(t)}}}}],[{key:"instance",value:function(){return this.mInstance||(this.mInstance=new this),this.mInstance}}]),e}();S.mInstance=void 0;var L=n(6),I=n(9),N=(n(18),function(e){Object(c.a)(n,e);var t=Object(u.a)(n);function n(e){var i,s;Object(a.a)(this,n),(s=t.call(this,e)).listRefs=new Map,s.inputRef=o.a.createRef(),s.fuse=void 0,s.state={result:[],selectedIndex:-1},s.onChange=s.onChange.bind(Object(L.a)(s)),s.onKeyDown=s.onKeyDown.bind(Object(L.a)(s)),s.onClick=s.onClick.bind(Object(L.a)(s)),s.onDoubleClick=s.onDoubleClick.bind(Object(L.a)(s));var r=(null===(i=s.props.widgets)||void 0===i?void 0:i.flat().map((function(e){return e.list})).flat())||[];return s.fuse=new I.a(r,{keys:["label"]}),s}return Object(l.a)(n,[{key:"moveFocusToSearch",value:function(){var e,t=null===(e=this.inputRef)||void 0===e?void 0:e.current;t&&t.focus()}},{key:"componentDidMount",value:function(){this.moveFocusToSearch()}},{key:"onClick",value:function(e,t){e.preventDefault(),e.stopPropagation(),this.moveFocusToSearch(),this.setState({selectedIndex:t})}},{key:"onDoubleClick",value:function(e,t){e.preventDefault(),e.stopPropagation(),this.moveFocusToSearch(),this.props.onSelected(this.state.result[t].link)}},{key:"onKeyDown",value:function(e){var t=this.state.selectedIndex,n=-1;if("ArrowUp"===e.key)t>0&&(n=t-1);else if("ArrowDown"===e.key)t<this.state.result.length-1&&(n=t+1);else{if("Enter"!==e.key)return;t>=0&&this.props.onSelected(this.state.result[t].link)}if(-1!==n){var i,o=this.state.result[n],s=null===(i=this.listRefs.get(o.id))||void 0===i?void 0:i.current;s&&s.scrollIntoView({block:"nearest",inline:"nearest"}),this.setState({selectedIndex:n})}e.preventDefault()}},{key:"render",value:function(){var e=this;return Object(d.jsxs)("div",{className:"link-selector",children:[Object(d.jsxs)("div",{className:"input-container",children:[Object(d.jsx)("i",{className:"fas fa-search icon"}),Object(d.jsx)("input",{type:"text",ref:this.inputRef,onKeyDown:this.onKeyDown,onChange:this.onChange,placeholder:"Search",spellCheck:"false",className:"input-box"})]}),Object(d.jsx)("div",{className:"list",children:Object(d.jsx)("ul",{children:this.state.result.map((function(t,n){var i,o;return Object(d.jsxs)("li",{onClick:function(t){return e.onClick(t,n)},onDoubleClick:function(t){return e.onDoubleClick(t,n)},className:n===e.state.selectedIndex?"selected":"none",ref:null!==(i=e.listRefs.get(t.id))&&void 0!==i?i:null,children:[Object(d.jsx)("i",{className:"list-image",children:e.image(t.link)}),Object(d.jsxs)("div",{children:[(null===(o=t.link.widget)||void 0===o?void 0:o.title)||""," - ",t.link.label]})]},t.id)}))})})]})}},{key:"onChange",value:function(e){var t=e.target.value,n=this.filter(t);this.listRefs=n.reduce((function(e,t){return e.set(t.id,o.a.createRef()),e}),new Map),this.setState({result:n,selectedIndex:n.length?0:-1})}},{key:"filter",value:function(e){return 0===e.length?[]:this.fuse.search(e).map((function(e){return{id:e.item.id,link:e.item}}))}},{key:"image",value:function(e){var t=y(e,this.context.faviconService);return t?Object(d.jsx)("img",{src:t,alt:""}):Object(d.jsx)("div",{className:"missing-image missing-favicon"})}}]),n}(o.a.Component));N.contextType=m;var D="hideShortcuts",F=function(e){Object(c.a)(n,e);var t=Object(u.a)(n);function n(e){var i;Object(a.a)(this,n),(i=t.call(this,e)).myLinksHolder=void 0,i.onLinkSelected=function(e){i.toggleModal(),window.requestIdleCallback((function(){return b(e)}))},i.toggleModal=function(){i.setState((function(e){return{isOpen:!e.isOpen}}))};var o=JSON.parse(JSON.stringify(f));return o.hideShortcuts=i.hideShortcuts,i.state={columns:[[]],config:o,hasShortcuts:!1,isOpen:!1},i}return Object(l.a)(n,[{key:"keyDown",value:function(e){return this.state.isOpen?"Escape"===e.key&&(this.toggleModal(),!0):" "===e.key?(e.stopPropagation(),e.preventDefault(),this.toggleModal(),!0):S.instance().keyDown(e)}},{key:"componentDidMount",value:function(){var e=this;document.addEventListener("keydown",(function(t){return e.keyDown(t)}),!1),w.fromData((function(t){e.reloadAll(t)}))}},{key:"render",value:function(){var e,t=this,n={visibility:this.state.hasShortcuts?"visible":"collapse"};return Object(d.jsx)(m.Provider,{value:this.state.config,children:Object(d.jsxs)("div",{className:"ml-wrapper",children:[Object(d.jsx)("div",{className:"ml-grid",children:Object(d.jsx)(O,{columns:this.state.columns})}),Object(d.jsxs)("label",{className:"toolbar-icon",title:"Load configuration from local file",children:[Object(d.jsx)("i",{className:"fa fa-file-import"}),Object(d.jsx)("input",{type:"file",id:"files",name:"files[]",accept:"application/json",onChange:function(e){return t.handleFileSelect(e)}})]}),Object(d.jsx)("label",{className:"toolbar-icon",title:"Toggle shortcuts visibility",style:n,onClick:function(){return t.onClickKeyboard()},children:Object(d.jsx)("i",{className:"fa fa-keyboard"})}),Object(d.jsx)(h,{show:this.state.isOpen,onClose:this.toggleModal,children:Object(d.jsx)(N,{onSelected:this.onLinkSelected,widgets:null===(e=this.myLinksHolder)||void 0===e?void 0:e.myLinks.columns})})]})})}},{key:"reloadAll",value:function(e){var t;e&&(this.myLinksHolder=new k(e),this.myLinksHolder.applyBackground(),this.myLinksHolder.applyTheme(),this.myLinksHolder.applyColorToFavIcon(null===(t=e.theme)||void 0===t?void 0:t.missingFavIconColor),S.instance().setup(this.myLinksHolder),this.setState({config:this.buildConfig(e),columns:e.columns,hasShortcuts:this.myLinksHolder.hasShortcuts()}))}},{key:"onClickKeyboard",value:function(){this.myLinksHolder&&(this.hideShortcuts=!this.hideShortcuts,this.setState({config:this.buildConfig(this.myLinksHolder.myLinks)}))}},{key:"handleFileSelect",value:function(e){var t=this;if(e.target){var n=e.target.files&&e.target.files[0];e.target.value="",n&&w.fromFile(n,(function(e){t.reloadAll(e)}))}}},{key:"hideShortcuts",get:function(){return"1"===localStorage.getItem(D)||!1},set:function(e){localStorage.setItem(D,e?"1":"0")}},{key:"buildConfig",value:function(e){var t,n;return{theme:{missingFavIconColor:null===(t=e.theme)||void 0===t?void 0:t.missingFavIconColor},faviconService:null===(n=e.config)||void 0===n?void 0:n.faviconService,hideShortcuts:this.hideShortcuts}}}]),n}(o.a.Component);var E=function(){return Object(d.jsx)(F,{})};Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));r.a.render(Object(d.jsx)(o.a.StrictMode,{children:Object(d.jsx)(E,{})}),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()})).catch((function(e){console.error(e.message)}))}},[[19,1,2]]]);